_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[28],{"38br":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sell",function(){return n("4UCa")}])},"4UCa":function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),i=n("o0o1"),o=n.n(i),c=n("HaE+"),u=n("1OyB"),l=n("vuIU"),f=n("JX7q"),s=n("Ji7U"),p=n("md7G"),d=n("foSv"),m=n("rePB"),h=n("h4VS"),v=n("4KRT"),g=n("nOHt"),y=n.n(g),b=n("lTCR"),O=n.n(b),j=n("2y/O"),w=n("VUBQ"),E=a.a.createElement;function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(p.a)(this,n)}}function _(){var e=Object(h.a)(["\n    mutation CREATE_ITEM_MUTATION(\n        $title: String!\n        $description: String!\n        $image: String\n        $largeImage: String\n        $price: Int!\n    ) {\n        createItem(\n            title: $title\n            description: $description\n            image: $image\n            largeImage: $largeImage\n            price: $price\n        ) {\n            id\n            title\n        }\n    }\n"]);return _=function(){return e},e}var R=O()(_()),x=function(e){Object(s.a)(n,e);var t=I(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(m.a)(Object(f.a)(e),"state",{title:"",description:"",image:"",largeImage:"",price:0}),Object(m.a)(Object(f.a)(e),"handleChange",(function(t){var n=t.target,r=n.name,a=n.type,i=n.value,o="number"===a?parseFloat(i):i;e.setState(Object(m.a)({},r,o))})),Object(m.a)(Object(f.a)(e),"uploadFile",function(){var t=Object(c.a)(o.a.mark((function t(n){var r,a,i,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.target.files,(a=new FormData).append("file",r[0]),a.append("upload_preset","second surf"),t.next=6,fetch("https://api.cloudinary.com/v1_1/lukedaviesweb/image/upload",{method:"POST",body:a});case 6:return i=t.sent,t.next=9,i.json();case 9:c=t.sent,console.log(c),e.setState({image:c.secure_url,largeImage:c.eager[0].secure_url});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return E(v.Mutation,{mutation:R,variables:this.state},(function(t,n){var r=n.loading,a=n.error;return E("form",{onSubmit:function(){var e=Object(c.a)(o.a.mark((function e(n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t();case 3:r=e.sent,r.data.createItem.title.replace(/\s/g,"-"),y.a.push({pathname:"/item",query:{id:r.data.createItem.id}}),console.log(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},E(w.a,{error:a}),E("fieldset",{disabled:r,"aria-busy":r},E("label",{htmlFor:"file"},"Image",E("input",{type:"file",id:"file",name:"file",placeholder:"upload an image",onChange:e.uploadFile,required:!0}),e.state.image&&E("img",{width:"200",src:e.state.image,alt:"preview"})),E("label",{htmlFor:"title"},"Title",E("input",{type:"text",id:"title",name:"title",placeholder:"Title",value:e.state.title,onChange:e.handleChange,required:!0})),E("label",{htmlFor:"description"},"Price",E("input",{type:"number",id:"price",name:"price",placeholder:"price",value:e.state.price,onChange:e.handleChange,required:!0})),E("label",{htmlFor:"description"},"Description",E("textarea",{type:"text",id:"description",name:"description",placeholder:"description",value:e.state.description,onChange:e.handleChange,required:!0})),E("button",{type:"submit"},"Submit")),E("p",null,e.state.title),E("p",null,e.state.description))}))}}]),n}(r.Component),C=n("YFqc"),T=n.n(C),S=n("vOnD"),q=S.d.div.withConfig({displayName:"styled__ListingStyled",componentId:"sc-7ob91f-0"})(["display:flex;flex-wrap:wrap;"]),L=S.d.div.withConfig({displayName:"styled__ItemStyled",componentId:"sc-7ob91f-1"})(["border:1px solid;flex:1 0 25%;padding:10px;img{max-width:250px;}"]),k=n("Ff2n"),D=a.a.createElement;function M(){var e=Object(h.a)(["\n    mutation DELETE_ITEM_MUTATION($id: ID!) {\n        deleteItem(id: $id) {\n            id\n        }\n    }\n"]);return M=function(){return e},e}var $=O()(M()),F=function(e,t){var n=e.readQuery({query:Q});n.items=n.items.filter((function(e){return e.id!==t.data.deleteItem.id})),e.writeQuery({query:Q,data:n})},N=function(e){var t=e.id,n=Object(k.a)(e,["id"]);return D(v.Mutation,{mutation:$,variables:{id:t},update:F},(function(e,t){return t.error?D("p",null,"Error!"):D("button",{onClick:function(){confirm("are you sure?")&&e()}},n.children)}))},P=a.a.createElement;function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(p.a)(this,n)}}var J=function(e){Object(s.a)(n,e);var t=U(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.item;return console.log(typeof e.image),P(L,null,e.image&&P("img",{src:e.image,alt:e.image.title}),P("h2",null,P(T.a,{href:{pathname:"/item",query:{id:e.id}}},P("a",null,e.title))),P("p",null,Object(j.a)(e.price)),P("p",null,e.description),P(T.a,{href:{pathname:"/update",query:{id:e.id}}},P("a",null,"Edit ",e.title)),P(N,{id:e.id},"Delete Item"))}}]),n}(r.Component),A=a.a.createElement;function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(p.a)(this,n)}}function K(){var e=Object(h.a)(["\n    query ALL_ITEMS_QUERY {\n        items {\n            id\n            title\n            price\n            description\n            image\n            largeImage\n        }\n    }\n"]);return K=function(){return e},e}var Q=O()(K()),B=function(e){Object(s.a)(n,e);var t=H(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return A("div",null,A("h2",null,"Item listing component"),A(v.Query,{query:Q},(function(e){var t=e.data,n=e.error;return e.loading?A("p",null,"Loading..."):n?A("p",null,"Error! $",n):(console.log(t),t.items.length?A(q,null,t.items.map((function(e){return A(J,{item:e,key:e.id})}))):A("p",null,"No Items"))})))}}]),n}(r.Component),V=a.a.createElement;t.default=function(e){return V("div",null,V(x,null),V(B,null))}},Ff2n:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("zLVn");function a(e,t){if(null==e)return{};var n,a,i=Object(r.a)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var i,o=a(n("q1tI")),c=n("elyg"),u=(n("g/15"),n("nOHt")),l=new Map,f=window.IntersectionObserver,s={};var p=function(e,t){var n=i||(f?i=new f((function(e){e.forEach((function(e){if(l.has(e.target)){var t=l.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(i.unobserve(e.target),l.delete(e.target),t())}}))}),{rootMargin:"200px"}):void 0);return n?(n.observe(e),l.set(e,t),function(){try{n.unobserve(e)}catch(t){console.error(t)}l.delete(e)}):function(){}};function d(e,t,n,r){(0,c.isLocalURL)(t)&&(e.prefetch(t,n,r).catch((function(e){0})),s[t+"%"+n]=!0)}var m=function(e){var t=!1!==e.prefetch,n=o.default.useState(),a=r(n,2),i=a[0],l=a[1],m=(0,u.useRouter)(),h=m&&m.pathname||"/",v=o.default.useMemo((function(){var t=(0,c.resolveHref)(h,e.href);return{href:t,as:e.as?(0,c.resolveHref)(h,e.as):t}}),[h,e.href,e.as]),g=v.href,y=v.as;o.default.useEffect((function(){if(t&&f&&i&&i.tagName&&(0,c.isLocalURL)(g)&&!s[g+"%"+y])return p(i,(function(){d(m,g,y)}))}),[t,i,g,y,m]);var b=e.children,O=e.replace,j=e.shallow,w=e.scroll;"string"===typeof b&&(b=o.default.createElement("a",null,b));var E=o.Children.only(b),I={ref:function(e){e&&l(e),E&&"object"===typeof E&&E.ref&&("function"===typeof E.ref?E.ref(e):"object"===typeof E.ref&&(E.ref.current=e))},onClick:function(e){E.props&&"function"===typeof E.props.onClick&&E.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,i,o){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,c.isLocalURL)(n))&&(e.preventDefault(),null==o&&(o=r.indexOf("#")<0),t[a?"replace":"push"](n,r,{shallow:i}).then((function(e){e&&o&&(window.scrollTo(0,0),document.body.focus())})))}(e,m,g,y,O,j,w)}};return t&&(I.onMouseEnter=function(e){(0,c.isLocalURL)(g)&&(E.props&&"function"===typeof E.props.onMouseEnter&&E.props.onMouseEnter(e),d(m,g,y,{priority:!0}))}),!e.passHref&&("a"!==E.type||"href"in E.props)||(I.href=(0,c.addBasePath)(y)),o.default.cloneElement(E,I)};t.default=m},zLVn:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,"a",(function(){return r}))}},[["38br",0,1,2,3,9,10,11]]]);